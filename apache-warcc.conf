<VirtualHost *:80>
    ServerName warcc.your-domain.com  # Use a subdomain to avoid conflicts
    ServerAlias www.warcc.your-domain.com
    DocumentRoot /var/www/warcc/public

    # Directory configuration
    <Directory /var/www/warcc/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted

        # Laravel-specific rewrite rules
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index.php [QSA,L]
    </Directory>

    # Security headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # PHP configuration specific to this site
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/var/run/php/php8.2-fpm.sock|fcgi://localhost"
    </FilesMatch>

    # Static file caching
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 year"
        Header append Cache-Control "public"
    </LocationMatch>

    # Upload size limit (adjust as needed)
    LimitRequestBody 104857600  # 100MB

    # Logging specific to this application
    ErrorLog ${APACHE_LOG_DIR}/warcc_error.log
    CustomLog ${APACHE_LOG_DIR}/warcc_access.log combined
    LogLevel warn
</VirtualHost>

# SSL Virtual Host (uncomment after getting SSL certificate)
#<VirtualHost *:443>
#    ServerName warcc.your-domain.com
#    ServerAlias www.warcc.your-domain.com
#    DocumentRoot /var/www/warcc/public
#
#    SSLEngine on
#    SSLCertificateFile /path/to/your/certificate.crt
#    SSLCertificateKeyFile /path/to/your/private.key
#    SSLCertificateChainFile /path/to/your/ca-bundle.crt
#
#    # Include all the Directory and other configurations from above
#    # ... (copy from the HTTP virtual host)
#</VirtualHost>
